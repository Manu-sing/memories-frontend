{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport posts from \"../services/posts\";\nimport postService from \"../services/posts\";\nconst postSlice = createSlice({\n  name: posts,\n  initialState: [],\n  reducers: {\n    setPosts(state, action) {\n      return action.payload;\n    },\n\n    appendPost(state, action) {\n      state.push(action.payload);\n    },\n\n    detachPost(state, action) {\n      const id = action.payload;\n      return state.filter(post => post._id !== id);\n    },\n\n    updateLike(state, action) {\n      const id = action.payload;\n      const postToLike = state.find(post => post._id === id);\n      const likedPost = { ...postToLike,\n        likeCount: postToLike.likeCount + 1\n      };\n      return state.map(post => post._id === id ? likedPost : post);\n    }\n\n  }\n});\nexport const {\n  setPosts,\n  appendPost,\n  detachPost,\n  updateLike\n} = postSlice.actions;\nexport const initialisePosts = () => {\n  return async dispatch => {\n    const posts = await postService.getAll();\n    dispatch(setPosts(posts));\n    console.log(posts);\n  };\n};\nexport const createPost = obj => {\n  return async dispatch => {\n    try {\n      const newPost = await postService.create(obj);\n      dispatch(appendPost(newPost));\n    } catch (error) {\n      console.log(\"Could not save the new post\");\n    }\n  };\n};\nexport const removePost = id => {\n  return async dispatch => {\n    try {\n      await postService.removeBlog(id);\n      dispatch(detachPost(id));\n    } catch (error) {\n      console.log(\"Could not delete the post\");\n    }\n  };\n};\nexport const likeAPost = (id, obj) => {\n  return async dispatch => {\n    await postService.update(id, obj);\n    dispatch(updateLike(id));\n  };\n};\nexport default postSlice.reducer;","map":{"version":3,"names":["createSlice","posts","postService","postSlice","name","initialState","reducers","setPosts","state","action","payload","appendPost","push","detachPost","id","filter","post","_id","updateLike","postToLike","find","likedPost","likeCount","map","actions","initialisePosts","dispatch","getAll","console","log","createPost","obj","newPost","create","error","removePost","removeBlog","likeAPost","update","reducer"],"sources":["/Users/emanueleguarnaccia/memories-frontend/client/src/reducers/postReducer.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport posts from \"../services/posts\";\nimport postService from \"../services/posts\";\n\nconst postSlice = createSlice({\n  name: posts,\n  initialState: [],\n  reducers: {\n    setPosts(state, action) {\n      return action.payload;\n    },\n    appendPost(state, action) {\n      state.push(action.payload);\n    },\n    detachPost(state, action) {\n      const id = action.payload;\n      return state.filter((post) => post._id !== id);\n    },\n    updateLike(state, action) {\n      const id = action.payload;\n      const postToLike = state.find((post) => post._id === id);\n      const likedPost = { ...postToLike, likeCount: postToLike.likeCount + 1 };\n      return state.map((post) => (post._id === id ? likedPost : post));\n    },\n  },\n});\n\nexport const { setPosts, appendPost, detachPost, updateLike } =\n  postSlice.actions;\n\nexport const initialisePosts = () => {\n  return async (dispatch) => {\n    const posts = await postService.getAll();\n    dispatch(setPosts(posts));\n    console.log(posts);\n  };\n};\n\nexport const createPost = (obj) => {\n  return async (dispatch) => {\n    try {\n      const newPost = await postService.create(obj);\n      dispatch(appendPost(newPost));\n    } catch (error) {\n      console.log(\"Could not save the new post\");\n    }\n  };\n};\n\nexport const removePost = (id) => {\n  return async (dispatch) => {\n    try {\n      await postService.removeBlog(id);\n      dispatch(detachPost(id));\n    } catch (error) {\n      console.log(\"Could not delete the post\");\n    }\n  };\n};\n\nexport const likeAPost = (id, obj) => {\n  return async (dispatch) => {\n    await postService.update(id, obj);\n    dispatch(updateLike(id));\n  };\n};\n\nexport default postSlice.reducer;\n"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AACA,OAAOC,KAAP,MAAkB,mBAAlB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AAEA,MAAMC,SAAS,GAAGH,WAAW,CAAC;EAC5BI,IAAI,EAAEH,KADsB;EAE5BI,YAAY,EAAE,EAFc;EAG5BC,QAAQ,EAAE;IACRC,QAAQ,CAACC,KAAD,EAAQC,MAAR,EAAgB;MACtB,OAAOA,MAAM,CAACC,OAAd;IACD,CAHO;;IAIRC,UAAU,CAACH,KAAD,EAAQC,MAAR,EAAgB;MACxBD,KAAK,CAACI,IAAN,CAAWH,MAAM,CAACC,OAAlB;IACD,CANO;;IAORG,UAAU,CAACL,KAAD,EAAQC,MAAR,EAAgB;MACxB,MAAMK,EAAE,GAAGL,MAAM,CAACC,OAAlB;MACA,OAAOF,KAAK,CAACO,MAAN,CAAcC,IAAD,IAAUA,IAAI,CAACC,GAAL,KAAaH,EAApC,CAAP;IACD,CAVO;;IAWRI,UAAU,CAACV,KAAD,EAAQC,MAAR,EAAgB;MACxB,MAAMK,EAAE,GAAGL,MAAM,CAACC,OAAlB;MACA,MAAMS,UAAU,GAAGX,KAAK,CAACY,IAAN,CAAYJ,IAAD,IAAUA,IAAI,CAACC,GAAL,KAAaH,EAAlC,CAAnB;MACA,MAAMO,SAAS,GAAG,EAAE,GAAGF,UAAL;QAAiBG,SAAS,EAAEH,UAAU,CAACG,SAAX,GAAuB;MAAnD,CAAlB;MACA,OAAOd,KAAK,CAACe,GAAN,CAAWP,IAAD,IAAWA,IAAI,CAACC,GAAL,KAAaH,EAAb,GAAkBO,SAAlB,GAA8BL,IAAnD,CAAP;IACD;;EAhBO;AAHkB,CAAD,CAA7B;AAuBA,OAAO,MAAM;EAAET,QAAF;EAAYI,UAAZ;EAAwBE,UAAxB;EAAoCK;AAApC,IACXf,SAAS,CAACqB,OADL;AAGP,OAAO,MAAMC,eAAe,GAAG,MAAM;EACnC,OAAO,MAAOC,QAAP,IAAoB;IACzB,MAAMzB,KAAK,GAAG,MAAMC,WAAW,CAACyB,MAAZ,EAApB;IACAD,QAAQ,CAACnB,QAAQ,CAACN,KAAD,CAAT,CAAR;IACA2B,OAAO,CAACC,GAAR,CAAY5B,KAAZ;EACD,CAJD;AAKD,CANM;AAQP,OAAO,MAAM6B,UAAU,GAAIC,GAAD,IAAS;EACjC,OAAO,MAAOL,QAAP,IAAoB;IACzB,IAAI;MACF,MAAMM,OAAO,GAAG,MAAM9B,WAAW,CAAC+B,MAAZ,CAAmBF,GAAnB,CAAtB;MACAL,QAAQ,CAACf,UAAU,CAACqB,OAAD,CAAX,CAAR;IACD,CAHD,CAGE,OAAOE,KAAP,EAAc;MACdN,OAAO,CAACC,GAAR,CAAY,6BAAZ;IACD;EACF,CAPD;AAQD,CATM;AAWP,OAAO,MAAMM,UAAU,GAAIrB,EAAD,IAAQ;EAChC,OAAO,MAAOY,QAAP,IAAoB;IACzB,IAAI;MACF,MAAMxB,WAAW,CAACkC,UAAZ,CAAuBtB,EAAvB,CAAN;MACAY,QAAQ,CAACb,UAAU,CAACC,EAAD,CAAX,CAAR;IACD,CAHD,CAGE,OAAOoB,KAAP,EAAc;MACdN,OAAO,CAACC,GAAR,CAAY,2BAAZ;IACD;EACF,CAPD;AAQD,CATM;AAWP,OAAO,MAAMQ,SAAS,GAAG,CAACvB,EAAD,EAAKiB,GAAL,KAAa;EACpC,OAAO,MAAOL,QAAP,IAAoB;IACzB,MAAMxB,WAAW,CAACoC,MAAZ,CAAmBxB,EAAnB,EAAuBiB,GAAvB,CAAN;IACAL,QAAQ,CAACR,UAAU,CAACJ,EAAD,CAAX,CAAR;EACD,CAHD;AAID,CALM;AAOP,eAAeX,SAAS,CAACoC,OAAzB"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from\"/Users/emanueleguarnaccia/memories-frontend/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/emanueleguarnaccia/memories-frontend/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/emanueleguarnaccia/memories-frontend/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{createSlice}from\"@reduxjs/toolkit\";import postService from\"../services/posts\";var postSlice=createSlice({name:\"posts\",initialState:[],reducers:{setPosts:function setPosts(state,action){return action.payload;},appendPost:function appendPost(state,action){state.push(action.payload);},detachPost:function detachPost(state,action){var id=action.payload;return state.filter(function(post){return post._id!==id;});},updateThePost:function updateThePost(state,action){return state.map(function(post){return post._id===action.payload._id?action.payload:post;});},likeIt:function likeIt(state,action){var id=action.payload;var postToLike=state.find(function(post){return post._id===id;});var likedPost=_objectSpread(_objectSpread({},postToLike),{},{likeCount:postToLike.likeCount+1});return state.map(function(post){return post._id===id?likedPost:post;});}}});var _postSlice$actions=postSlice.actions,setPosts=_postSlice$actions.setPosts,appendPost=_postSlice$actions.appendPost,detachPost=_postSlice$actions.detachPost,updateThePost=_postSlice$actions.updateThePost,likeIt=_postSlice$actions.likeIt;export{setPosts,appendPost,detachPost,updateThePost,likeIt};export var initialisePosts=function initialisePosts(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var posts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return postService.getAll();case 2:posts=_context.sent;dispatch(setPosts(posts));console.log(posts);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var createPost=function createPost(setMessage,setTypeOfMessage,obj){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var newPost;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return postService.create(obj);case 3:newPost=_context2.sent;dispatch(appendPost(newPost));setTypeOfMessage(\"success\");setMessage(\"Your new post was created succesfully.\");setTimeout(function(){setMessage(null);setTypeOfMessage(null);},6000);_context2.next=16;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);setTypeOfMessage(\"error\");setMessage(\"Could not create the new post.\");setTimeout(function(){setMessage(null);setTypeOfMessage(null);},6000);console.log(_context2.t0);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var removePost=function removePost(setMessage,setTypeOfMessage,id){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return postService.removeThePost(id);case 3:dispatch(detachPost(id));setTypeOfMessage(\"success\");setMessage(\"Your new post was deleted succesfully.\");setTimeout(function(){setMessage(null);setTypeOfMessage(null);},8000);_context3.next=15;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);setTypeOfMessage(\"error\");setMessage(\"Could not delete the post.\");setTimeout(function(){setMessage(null);setTypeOfMessage(null);},8000);console.log(_context3.t0);case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var updatePost=function updatePost(id,obj){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var updatedPost;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return postService.update(id,obj);case 2:updatedPost=_context4.sent;dispatch(updateThePost(updatedPost));case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var likeAPost=function likeAPost(id,obj){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return postService.update(id,obj);case 2:dispatch(likeIt(id));case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export default postSlice.reducer;","map":{"version":3,"names":["createSlice","postService","postSlice","name","initialState","reducers","setPosts","state","action","payload","appendPost","push","detachPost","id","filter","post","_id","updateThePost","map","likeIt","postToLike","find","likedPost","likeCount","actions","initialisePosts","dispatch","getAll","posts","console","log","createPost","setMessage","setTypeOfMessage","obj","create","newPost","setTimeout","removePost","removeThePost","updatePost","update","updatedPost","likeAPost","reducer"],"sources":["/Users/emanueleguarnaccia/memories-frontend/client/src/reducers/postReducer.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport postService from \"../services/posts\";\n\nconst postSlice = createSlice({\n  name: \"posts\",\n  initialState: [],\n  reducers: {\n    setPosts(state, action) {\n      return action.payload;\n    },\n    appendPost(state, action) {\n      state.push(action.payload);\n    },\n    detachPost(state, action) {\n      const id = action.payload;\n      return state.filter((post) => post._id !== id);\n    },\n    updateThePost(state, action) {\n      return state.map((post) =>\n        post._id === action.payload._id ? action.payload : post\n      );\n    },\n    likeIt(state, action) {\n      const id = action.payload;\n      const postToLike = state.find((post) => post._id === id);\n      const likedPost = { ...postToLike, likeCount: postToLike.likeCount + 1 };\n      return state.map((post) => (post._id === id ? likedPost : post));\n    },\n  },\n});\n\nexport const { setPosts, appendPost, detachPost, updateThePost, likeIt } =\n  postSlice.actions;\n\nexport const initialisePosts = () => {\n  return async (dispatch) => {\n    const posts = await postService.getAll();\n    dispatch(setPosts(posts));\n    console.log(posts);\n  };\n};\n\nexport const createPost = (setMessage, setTypeOfMessage, obj) => {\n  return async (dispatch) => {\n    try {\n      const newPost = await postService.create(obj);\n      dispatch(appendPost(newPost));\n      setTypeOfMessage(\"success\");\n      setMessage(\"Your new post was created succesfully.\");\n      setTimeout(() => {\n        setMessage(null);\n        setTypeOfMessage(null);\n      }, 6000);\n    } catch (error) {\n      setTypeOfMessage(\"error\");\n      setMessage(\"Could not create the new post.\");\n      setTimeout(() => {\n        setMessage(null);\n        setTypeOfMessage(null);\n      }, 6000);\n      console.log(error);\n    }\n  };\n};\n\nexport const removePost = (setMessage, setTypeOfMessage, id) => {\n  return async (dispatch) => {\n    try {\n      await postService.removeThePost(id);\n      dispatch(detachPost(id));\n      setTypeOfMessage(\"success\");\n      setMessage(\"Your new post was deleted succesfully.\");\n      setTimeout(() => {\n        setMessage(null);\n        setTypeOfMessage(null);\n      }, 8000);\n    } catch (error) {\n      setTypeOfMessage(\"error\");\n      setMessage(\"Could not delete the post.\");\n      setTimeout(() => {\n        setMessage(null);\n        setTypeOfMessage(null);\n      }, 8000);\n      console.log(error);\n    }\n  };\n};\n\nexport const updatePost = (id, obj) => {\n  return async (dispatch) => {\n    const updatedPost = await postService.update(id, obj);\n    dispatch(updateThePost(updatedPost));\n  };\n};\n\nexport const likeAPost = (id, obj) => {\n  return async (dispatch) => {\n    await postService.update(id, obj);\n    dispatch(likeIt(id));\n  };\n};\n\nexport default postSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}